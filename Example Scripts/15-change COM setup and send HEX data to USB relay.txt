# 本示例展示了如何通过脚本更改COM口的设置和开关COM口，也展示了如何发送二进制数而不是字符串
# this is an example of changing COM port and sending data in binary instead of string
# and also this is an example of controlling a power rely connected to a USB-to-COM port, and it need to set status by sending HEX numbers.
# if the content of sent string is in format like send_line("\xA0\x01\x01\xA2"), COM port will not send string "\xA0\x01\x01\xA2", instead it will send 0xA0 01 01 A2, which are HEX number.

close_serial()
wait 1
set_port("COM20")
show_str("set COM20\n")
wait 1
set_baudrate("9600")
show_str("set baudrate to 9600\n")
wait 1

connect_serial()
wait 1
# A0 01 01 A2 打开继电器
send_line("\xA0\x01\x01\xA2")
wait 3
# A0 01 00 A1 关闭继电器
send_line("\xA0\x01\x00\xA1")
wait 3

close_serial()
wait 1
set_port("COM3")
show_str("set COM3\n")
wait 1
set_baudrate("115200")
show_str("set baudrate to 115200\n")
wait 1
connect_serial()
wait 1

